(function(){$(function(){return $(".submit-once").live("submit",function(){return $(this).data("submited")?!1:$(this).data("submited",!0)})})}).call(this),function(e){function r(t){var n={},r=/^jQuery\d+$/;return e.each(t.attributes,function(e,t){t.specified&&!r.test(t.name)&&(n[t.name]=t.value)}),n}function i(){var t=e(this);t.val()===t.attr("placeholder")&&t.hasClass("placeholder")&&(t.data("placeholder-password")?t.hide().next().attr("id",t.removeAttr("id").data("placeholder-id")).show().focus():t.val("").removeClass("placeholder"))}function s(){var t,n=e(this),s=n,o=this.id;if(n.val()===""){if(n.is(":password")){if(!n.data("placeholder-textinput")){try{t=n.clone().attr({type:"text"})}catch(u){t=e("<input>").attr(e.extend(r(this),{type:"text"}))}t.removeAttr("name").data("placeholder-password",!0).data("placeholder-id",o).bind("focus.placeholder",i),n.data("placeholder-textinput",t).data("placeholder-id",o).before(t)}n=n.removeAttr("id").hide().prev().attr("id",o).show()}n.addClass("placeholder").val(n.attr("placeholder"))}else n.removeClass("placeholder")}var t="placeholder"in document.createElement("input"),n="placeholder"in document.createElement("textarea");t&&n?(e.fn.placeholder=function(){return this},e.fn.placeholder.input=e.fn.placeholder.textarea=!0):(e.fn.placeholder=function(){return this.filter((t?"textarea":":input")+"[placeholder]").bind("focus.placeholder",i).bind("blur.placeholder",s).trigger("blur.placeholder").end()},e.fn.placeholder.input=t,e.fn.placeholder.textarea=n,e(function(){e("form").bind("submit.placeholder",function(){var t=e(".placeholder",this).each(i);setTimeout(function(){t.each(s)},10)})}),e(window).bind("unload.placeholder",function(){e(".placeholder").val("")}))}(jQuery),function(){app.on(".auth-content",function(e,t,n){var r,i,s,o,u,a;s=t(".auth-popup"),u=t("@signup-form"),t("@show-signup-form").click(function(){return s.addClass("signup-opened"),!1}),i=function(e){var t;return t=parseInt(s.css("marginLeft")),s.animate({marginLeft:t-50},170,"easeOutBack").animate({marginLeft:t},1700,"easeOutElastic"),app.flash.error(e)},u.submit(function(){return t("@signup-email").val()===""?(t("@signup-email").focus(),i("Ввведите свой адрес эл. почты"),!1):t("@signup-password").val()===""?(t("@signup-password").focus(),i("Введите пароль"),!1):t("@offer-agree").prop("checked")?e(this).data("submited")?!1:e(this).data("submited",!0):(t("@offer-agree").focus(),i("Для регистрации вам нужно согласиться с условиями оферты"),!1)}),s.hasClass("user-exists")&&t("@signup-email").focus(),t("@show-remind").click(function(){return s.toggleClass("remind-opened"),!1}),t("@hide-remind").click(function(){return s.removeClass("remind-opened"),!1}),s.hasClass("wrong-password")&&t("@signin-password").focus(),e.browser.msie&&t(":text, [type=email], :password").placeholder(),e("@show-auth-popup").click(function(t,r){var i,u;return r||(r=n.data("redirectTo")),r!=null&&e.cookie("redirect_to",r,{path:"/"}),((u=app.currentPage)!=null?u.redirectTo:void 0)!=null&&e.cookie("redirect_to",app.currentPage.redirectTo,{path:"/"}),e(".auth-content").removeClass("hide"),i=s.height(),s.hide(),o.css({opacity:0}).animate({opacity:.3},300,"easeOutQuad",function(){return s.show().css({marginTop:-e("body").height()-i}).animate({marginTop:a},450,"easeOutQuad",function(){return s.find("@signin-email input").focus()})}),!1}),o=e("@auth-shadow"),a=parseInt(s.css("marginTop")),r=function(){return e.cookie("redirect_to",null,{path:"/"}),s.animate({marginTop:e("body").height()},450,"easeInQuad",function(){return o.animate({opacity:0},300,function(){return e(".auth-content").addClass("hide")})})};if(s.hasClass("closable"))return o.click(function(){return r()})})}.call(this);